
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–π –∞–∫–∫–∞—É–Ω—Ç | –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–æ—à–∫–æ–ª—å–Ω–∏–∫–æ–≤</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Arial Rounded MT Bold', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
        }

        .header {
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            font-size: 2rem;
            color: #ffcc00;
        }

        .logo h1 {
            font-size: 1.8rem;
            text-shadow: 2px 2px 0 #4a148c;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            margin-right: 20px;
        }

        .nav-btn {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
        }

        .nav-btn:hover {
            background-color: white;
            color: #6a11cb;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            font-weight: bold;
        }

        .user-details h2 {
            font-size: 1.4rem;
            margin-bottom: 5px;
        }

        .user-details .role {
            background-color: rgba(255, 255, 255, 0.2);
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
            display: inline-block;
        }

        .logout-btn {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .logout-btn:hover {
            background-color: white;
            color: #6a11cb;
        }

        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .welcome-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            text-align: center;
        }

        .welcome-title {
            color: #4a148c;
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .welcome-message {
            color: #5d4037;
            font-size: 1.2rem;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #ffcc00;
        }

        .card-icon {
            font-size: 2rem;
            color: #6a11cb;
        }

        .card-title {
            color: #4a148c;
            font-size: 1.5rem;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ */
        .admin-card {
            border-top: 5px solid #ff6b6b;
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-box {
            background: linear-gradient(135deg, #6a11cb, #2575fc);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .reviews-list {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .review-item {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #ffcc00;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .review-author {
            font-weight: bold;
            color: #4a148c;
        }

        .review-date {
            color: #757575;
            font-size: 0.9rem;
        }

        .review-rating {
            color: #ffcc00;
            margin-bottom: 10px;
        }

        .review-text {
            color: #5d4037;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .comment-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
        }

        .comment-item {
            background-color: #f0f8ff;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.85rem;
        }

        .comment-author {
            color: #2575fc;
            font-weight: bold;
        }

        .comment-date {
            color: #888;
        }

        .comment-form {
            margin-top: 10px;
        }

        .comment-input {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #ffcc00;
            border-radius: 10px;
            font-size: 0.9rem;
            resize: vertical;
            margin-bottom: 8px;
        }

        .comment-btn {
            background: linear-gradient(to right, #4CAF50, #8BC34A);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤ */
        .rating-stars {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
        }

        .star {
            font-size: 1.5rem;
            color: #ddd;
            cursor: pointer;
            transition: color 0.2s;
        }

        .star.active {
            color: #ffcc00;
        }

        .review-form textarea {
            width: 100%;
            height: 120px;
            padding: 15px;
            border: 3px solid #ffcc00;
            border-radius: 15px;
            font-size: 1rem;
            resize: vertical;
            margin-bottom: 15px;
        }

        .review-form textarea:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        .submit-review-btn {
            background: linear-gradient(to right, #ff6b6b, #ff8e53);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-review-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—è */
        .parent-card {
            border-top: 5px solid #4caf50;
        }

        .children-list {
            margin: 15px 0;
        }

        .child-item {
            background: linear-gradient(135deg, #f5f7fa, #e3f2fd);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .child-name {
            font-weight: bold;
            color: #4a148c;
        }

        .child-age {
            color: #666;
            font-size: 0.9rem;
        }

        .child-progress {
            font-size: 0.9rem;
            color: #4CAF50;
            font-weight: bold;
        }

        .add-child-btn {
            background: linear-gradient(to right, #4CAF50, #8BC34A);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
        }

        .site-rating {
            text-align: center;
            margin-bottom: 20px;
        }

        .average-rating {
            font-size: 3rem;
            font-weight: bold;
            color: #4a148c;
            margin-bottom: 10px;
        }

        .rating-description {
            color: #5d4037;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .rating-distribution {
            margin-top: 20px;
        }

        .distribution-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .distribution-star {
            width: 80px;
            color: #ffcc00;
        }

        .distribution-bar {
            flex: 1;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin: 0 10px;
            overflow: hidden;
        }

        .distribution-fill {
            height: 100%;
            background: linear-gradient(to right, #ff6b6b, #ff8e53);
            border-radius: 10px;
        }

        .distribution-percent {
            width: 40px;
            text-align: right;
            color: #5d4037;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —É—á–µ–Ω–∏–∫–∞ */
        .child-card {
            border-top: 5px solid #ff9800;
        }

        .child-progress-info {
            text-align: center;
            margin-bottom: 20px;
        }

        .progress-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #4a148c;
        }

        .progress-label {
            color: #666;
            font-size: 1rem;
        }

        .progress-bar-container {
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #6a11cb, #2575fc);
            border-radius: 10px;
            transition: width 0.5s ease-in-out;
        }

        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤ */
        .all-reviews-section {
            margin-top: 25px;
        }

        .section-title {
            color: #4a148c;
            font-size: 1.3rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ffcc00;
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal {
            background: white;
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            color: #4a148c;
            font-size: 1.5rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: #5d4037;
            font-weight: bold;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border-radius: 10px;
            border: 2px solid #ffcc00;
            font-size: 1rem;
        }

        .modal-submit-btn {
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
        }

        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ */
        .footer {
            text-align: center;
            padding: 30px;
            color: #5d4037;
            border-top: 2px dashed #ffcc00;
            margin-top: 40px;
        }

        .hidden {
            display: none !important;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            animation: fadeIn 0.5s ease-out;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .nav-buttons {
                margin-right: 0;
                justify-content: center;
            }

            .user-info {
                flex-direction: column;
            }

            .dashboard {
                grid-template-columns: 1fr;
            }

            .welcome-title {
                font-size: 1.6rem;
            }

            .admin-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 15px;
            }

            .card {
                padding: 20px;
            }

            .admin-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-laptop-code logo-icon"></i>
                <h1>–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–æ—à–∫–æ–ª—å–Ω–∏–∫–æ–≤</h1>
            </div>
            <div class="nav-buttons">
                <a href="proektsayt.html" class="nav-btn">
                    <i class="fas fa-home"></i> –ì–ª–∞–≤–Ω–∞—è
                </a>
                <a href="zadachi.html" target="_blank" class="nav-btn">
                    <i class="fas fa-tasks"></i> –ó–∞–¥–∞—á–∏
                </a>
                <a href="tren.html" target="_blank" class="nav-btn">
                    <i class="fas fa-gamepad"></i> –¢—Ä–µ–Ω–∞–∂–µ—Ä
                </a>
            </div>
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">U</div>
                <div class="user-details">
                    <h2 id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h2>
                    <div class="role" id="userRole">–†–æ–ª—å</div>
                </div>
                <button class="logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="welcome-section">
            <h1 class="welcome-title" id="welcomeTitle">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
            <p class="welcome-message" id="welcomeMessage">–ú—ã —Ä–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å –≤ –Ω–∞—à–µ–º –æ–±—É—á–∞—é—â–µ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.</p>
        </div>

        <div class="dashboard">
            <!-- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
            <div class="card admin-card" id="adminPanel">
                <div class="card-header">
                    <i class="fas fa-crown card-icon"></i>
                    <h2 class="card-title">–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
                </div>

                <div class="admin-stats">
                    <div class="stat-box">
                        <div class="stat-number" id="totalUsers">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="totalReviews">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –æ—Ç–∑—ã–≤–æ–≤</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="avgRating">0.0</div>
                        <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="newToday">0</div>
                        <div class="stat-label">–ù–æ–≤—ã—Ö —Å–µ–≥–æ–¥–Ω—è</div>
                    </div>
                </div>

                <div style="margin: 20px 0;">
                    <a href="admin.html" style="text-decoration: none;">
                        <button style="background: linear-gradient(to right, #6a11cb, #2575fc); color: white; border: none; padding: 12px 25px; border-radius: 15px; font-size: 1.1rem; font-weight: bold; cursor: pointer; width: 100%;">
                            <i class="fas fa-cogs"></i> –ü–µ—Ä–µ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                        </button>
                    </a>
                </div>

                <h3 style="margin-bottom: 15px; color: #4a148c;">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã</h3>
                <div class="reviews-list" id="adminReviewsList">
                    <!-- –û—Ç–∑—ã–≤—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å —Ä–æ–¥–∏—Ç–µ–ª—è -->
            <div class="card parent-card" id="parentPanel">
                <div class="card-header">
                    <i class="fas fa-user-friends card-icon"></i>
                    <h2 class="card-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ç—å–º–∏</h2>
                </div>

                <div class="children-list" id="childrenList">
                    <!-- –°–ø–∏—Å–æ–∫ –¥–µ—Ç–µ–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
                </div>

                <button class="add-child-btn" onclick="openAddChildModal()">
                    <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–±—ë–Ω–∫–∞
                </button>

                <div class="site-rating">
                    <div class="average-rating" id="averageRating">0.0</div>
                    <div class="rating-description" id="ratingDescription">–ù–∞ –æ—Å–Ω–æ–≤–µ –æ—Ü–µ–Ω–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>

                    <div class="rating-distribution">
                        <!-- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                </div>

                <div class="all-reviews-section">
                    <h3 class="section-title">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h3>
                    <div class="review-form" id="parentReviewForm">
                        <div class="rating-stars" id="parentRatingStars">
                            <i class="fas fa-star star" data-value="1"></i>
                            <i class="fas fa-star star" data-value="2"></i>
                            <i class="fas fa-star star" data-value="3"></i>
                            <i class="fas fa-star star" data-value="4"></i>
                            <i class="fas fa-star star" data-value="5"></i>
                        </div>
                        <textarea id="parentReviewText" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–º –æ–ø—ã—Ç–µ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π..."></textarea>
                        <button class="submit-review-btn" id="submitParentReviewBtn">
                            <i class="fas fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤
                        </button>
                    </div>
                </div>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å —É—á–µ–Ω–∏–∫–∞ -->
            <div class="card child-card" id="childPanel">
                <div class="card-header">
                    <i class="fas fa-child card-icon"></i>
                    <h2 class="card-title">–ú–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å</h2>
                </div>

                <div class="child-progress-info">
                    <div class="progress-number" id="childProgressPercent">0%</div>
                    <div class="progress-label" id="childProgressText">0 –∏–∑ 7 —Ç–µ–º –∏–∑—É—á–µ–Ω–æ</div>
                </div>

                <div class="progress-bar-container">
                    <div class="progress-bar" id="childProgressBar" style="width: 0%"></div>
                </div>

                <div style="margin: 20px 0; text-align: center;">
                    <a href="proektsayt.html" style="text-decoration: none;">
                        <button style="background: linear-gradient(to right, #ff9800, #ffb74d); color: white; border: none; padding: 12px 25px; border-radius: 15px; font-size: 1.1rem; font-weight: bold; cursor: pointer;">
                            <i class="fas fa-rocket"></i> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ
                        </button>
                    </a>
                </div>

                <div class="all-reviews-section">
                    <h3 class="section-title">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h3>
                    <div class="review-form" id="childReviewForm">
                        <div class="rating-stars" id="childRatingStars">
                            <i class="fas fa-star star" data-value="1"></i>
                            <i class="fas fa-star star" data-value="2"></i>
                            <i class="fas fa-star star" data-value="3"></i>
                            <i class="fas fa-star star" data-value="4"></i>
                            <i class="fas fa-star star" data-value="5"></i>
                        </div>
                        <textarea id="childReviewText" placeholder="–ß—Ç–æ —Ç–µ–±–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å –≤ –æ–±—É—á–µ–Ω–∏–∏?"></textarea>
                        <button class="submit-review-btn" id="submitChildReviewBtn">
                            <i class="fas fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤
                        </button>
                    </div>
                </div>
            </div>

            <!-- –û–±—â–∞—è –ø–∞–Ω–µ–ª—å —Å –æ—Ç–∑—ã–≤–∞–º–∏ (–¥–ª—è –≤—Å–µ—Ö —Ä–æ–ª–µ–π) -->
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-comments card-icon"></i>
                    <h2 class="card-title">–û—Ç–∑—ã–≤—ã –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
                </div>
                <div class="reviews-list" id="allReviewsList" style="max-height: 400px;">
                    <!-- –í—Å–µ –æ—Ç–∑—ã–≤—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ -->
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-chart-line card-icon"></i>
                    <h2 class="card-title">–ú–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å</h2>
                </div>
                <div style="color: #5d4037;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>–ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ–º:</span>
                        <span id="themesCompleted">0 –∏–∑ 7</span>
                    </div>
                    <div style="height: 20px; background-color: #e0e0e0; border-radius: 10px; overflow: hidden;">
                        <div id="progressBar" style="height: 100%; width: 0%; background: linear-gradient(to right, #6a11cb, #2575fc); border-radius: 10px;"></div>
                    </div>
                    <div style="margin-top: 15px; font-size: 0.9rem; color: #666;">
                        <p>–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π –æ–±—É—á–µ–Ω–∏—è</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–±–µ–Ω–∫–∞ -->
    <div class="modal-overlay" id="addChildModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–±—ë–Ω–∫–∞</h3>
                <button class="close-modal" onclick="closeAddChildModal()">&times;</button>
            </div>
            <form id="addChildForm" onsubmit="addChild(event)">
                <div class="form-group">
                    <label class="form-label">–ò–º—è —Ä–µ–±—ë–Ω–∫–∞</label>
                    <input type="text" class="form-input" id="childName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">–í–æ–∑—Ä–∞—Å—Ç (3-7 –ª–µ—Ç)</label>
                    <input type="number" class="form-input" id="childAge" min="3" max="7" required>
                </div>
                <button type="submit" class="modal-submit-btn">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <div class="footer">
        <p>¬© 2023 –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–æ—à–∫–æ–ª—å–Ω–∏–∫–æ–≤. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        <p style="margin-top: 10px;">–°–∞–π—Ç —Å–æ–∑–¥–∞–Ω —Å ‚ù§Ô∏è –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤</p>
    </div>

    <script>
        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è localStorage
        const USERS_KEY = 'preschool_programming_users';
        const REVIEWS_KEY = 'preschool_programming_reviews';
        const CURRENT_USER_KEY = 'currentUser';
        const PROGRESS_KEY = 'preschool_programming_progress';
        const CHILDREN_KEY = 'preschool_programming_children';

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        function initData() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
            if (!localStorage.getItem(REVIEWS_KEY)) {
                const sampleReviews = [
                    {
                        id: '1',
                        author: '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞',
                        authorId: '1',
                        role: 'parent',
                        rating: 5,
                        text: '–û—Ç–ª–∏—á–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º! –†–µ–±—ë–Ω–æ–∫ –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ.',
                        date: '2023-10-15',
                        likes: 12,
                        status: 'approved',
                        adminComments: []
                    },
                    {
                        id: '2',
                        author: '–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞',
                        authorId: '2',
                        role: 'parent',
                        rating: 4,
                        text: '–•–æ—Ä–æ—à–∏–µ —É—Ä–æ–∫–∏, –Ω–æ —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã –±–æ–ª—å—à–µ –∏–≥—Ä–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Å–∞–º—ã—Ö –º–∞–ª–µ–Ω—å–∫–∏—Ö.',
                        date: '2023-10-14',
                        likes: 8,
                        status: 'approved',
                        adminComments: []
                    },
                    {
                        id: '3',
                        author: '–°–µ—Ä–≥–µ–π –°–º–∏—Ä–Ω–æ–≤',
                        authorId: '3',
                        role: 'parent',
                        rating: 5,
                        text: '–†–µ–±—ë–Ω–æ–∫ (6 –ª–µ—Ç) —Å–∞–º –ø—Ä–æ—Å–∏—Ç –ø–æ–∑–∞–Ω–∏–º–∞—Ç—å—Å—è! –û—á–µ–Ω—å –Ω—Ä–∞–≤–∏—Ç—Å—è –≥–Ω–æ–º–∏–∫-–ø–æ–º–æ—â–Ω–∏–∫.',
                        date: '2023-10-13',
                        likes: 15,
                        status: 'approved',
                        adminComments: []
                    },
                    {
                        id: '4',
                        author: '–ö–∞—Ç—è –í–∞—Å–∏–ª—å–µ–≤–∞',
                        authorId: '4',
                        role: 'child',
                        rating: 5,
                        text: '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∏–≥—Ä–∞—Ç—å —Å –∫–æ—Ç–∏–∫–æ–º-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–º! –û–Ω –≤–µ—Å—ë–ª—ã–π –∏ –≤—Å—ë –ø–æ–Ω—è—Ç–Ω–æ –æ–±—ä—è—Å–Ω—è–µ—Ç.',
                        date: '2023-10-12',
                        likes: 20,
                        status: 'approved',
                        adminComments: []
                    }
                ];
                localStorage.setItem(REVIEWS_KEY, JSON.stringify(sampleReviews));
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Ç–µ–π, –µ—Å–ª–∏ –Ω–µ—Ç
            if (!localStorage.getItem(CHILDREN_KEY)) {
                localStorage.setItem(CHILDREN_KEY, JSON.stringify({}));
            }
        }

        // –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getCurrentUser() {
            const user = sessionStorage.getItem(CURRENT_USER_KEY);
            return user ? JSON.parse(user) : null;
        }

        // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function getUsers() {
            const users = localStorage.getItem(USERS_KEY);
            return users ? JSON.parse(users) : [];
        }

        // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ—Ç–∑—ã–≤—ã
        function getReviews() {
            const reviews = localStorage.getItem(REVIEWS_KEY);
            return reviews ? JSON.parse(reviews) : [];
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–∑—ã–≤
        function saveReview(review) {
            const reviews = getReviews();
            review.id = Date.now().toString();
            review.date = new Date().toLocaleDateString('ru-RU') + ' ' +
                          new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'});
            review.likes = 0;
            review.status = 'pending'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
            review.adminComments = [];
            reviews.push(review);
            localStorage.setItem(REVIEWS_KEY, JSON.stringify(reviews));
            return review;
        }

        // –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∞–π—Ç–∞
        function getSiteStats() {
            const users = getUsers();
            const reviews = getReviews();

            // –°—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥
            const approvedReviews = reviews.filter(r => r.status === 'approved');
            const totalRating = approvedReviews.reduce((sum, review) => sum + review.rating, 0);
            const avgRating = approvedReviews.length > 0 ? (totalRating / approvedReviews.length).toFixed(1) : '0.0';

            // –°—á–∏—Ç–∞–µ–º –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ —Å–µ–≥–æ–¥–Ω—è
            const today = new Date().toLocaleDateString('ru-RU');
            const newToday = users.filter(user => {
                const userDate = new Date(user.createdAt).toLocaleDateString('ru-RU');
                return userDate === today;
            }).length;

            // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
            const ratingDistribution = {5: 0, 4: 0, 3: 0, 2: 0, 1: 0};
            approvedReviews.forEach(review => {
                ratingDistribution[review.rating]++;
            });

            return {
                totalUsers: users.length,
                totalReviews: reviews.length,
                avgRating: avgRating,
                newToday: newToday,
                ratingDistribution: ratingDistribution
            };
        }

        // –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getUserProgress(userId) {
            const allProgress = JSON.parse(localStorage.getItem(PROGRESS_KEY) || '{}');
            return allProgress[userId] || {};
        }

        // –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–µ–π —Ä–æ–¥–∏—Ç–µ–ª—è
        function getChildren(parentId) {
            const allChildren = JSON.parse(localStorage.getItem(CHILDREN_KEY) || '{}');
            return allChildren[parentId] || [];
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–µ—Ç–µ–π —Ä–æ–¥–∏—Ç–µ–ª—è
        function saveChildren(parentId, children) {
            const allChildren = JSON.parse(localStorage.getItem(CHILDREN_KEY) || '{}');
            allChildren[parentId] = children;
            localStorage.setItem(CHILDREN_KEY, JSON.stringify(allChildren));
        }

        // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        function logout() {
            sessionStorage.removeItem(CURRENT_USER_KEY);
            window.location.href = 'login.html';
        }

        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function initPage() {
            initData();

            const currentUser = getCurrentUser();

            if (!currentUser) {
                alert('–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã!');
                window.location.href = 'login.html';
                return;
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
            updateUserInfo(currentUser);

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
            loadRoleSpecificData(currentUser.role);

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∞–π—Ç–∞
            loadSiteStats();

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            if (currentUser.role === 'admin') {
                loadLatestReviews();
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–µ—Ç–µ–π –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—è
            if (currentUser.role === 'parent') {
                loadChildren(currentUser.id);
                initParentReview();
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞
            if (currentUser.role === 'child') {
                loadChildProgress(currentUser.id);
                initChildReview();
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ –æ—Ç–∑—ã–≤—ã
            loadAllReviews();

            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            updateProgress(currentUser);

            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤—ã—Ö–æ–¥–∞
            document.getElementById('logoutBtn').addEventListener('click', logout);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        function updateUserInfo(user) {
            document.getElementById('userName').textContent = user.fullName;
            document.getElementById('userAvatar').textContent = user.fullName.charAt(0).toUpperCase();

            let roleText = '';
            let welcomeMessage = '';

            switch(user.role) {
                case 'admin':
                    roleText = 'üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä';
                    welcomeMessage = `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, ${user.fullName}! –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–∞–π—Ç–æ–º –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.`;
                    break;
                case 'parent':
                    roleText = 'üë®‚Äçüë©‚Äçüëß –†–æ–¥–∏—Ç–µ–ª—å';
                    const childCount = getChildren(user.id).length;
                    const childrenText = childCount > 0 ? ` (—É –≤–∞—Å ${childCount} ${childCount === 1 ? '—Ä–µ–±—ë–Ω–æ–∫' : childCount < 5 ? '—Ä–µ–±—ë–Ω–∫–∞' : '–¥–µ—Ç–µ–π'})` : '';
                    welcomeMessage = `–†–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å —Å–Ω–æ–≤–∞, ${user.fullName}!${childrenText} –°–ª–µ–¥–∏—Ç–µ –∑–∞ —É—Å–ø–µ—Ö–∞–º–∏ –≤–∞—à–∏—Ö –¥–µ—Ç–µ–π –≤ –æ–±—É—á–µ–Ω–∏–∏.`;
                    break;
                case 'child':
                    roleText = 'üë¶ –î–æ—à–∫–æ–ª—å–Ω–∏–∫';
                    welcomeMessage = `–ü—Ä–∏–≤–µ—Ç, ${user.fullName}! –ì–æ—Ç–æ–≤ –∫ –Ω–æ–≤—ã–º –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º —Å –ì–Ω–æ–º–∏–∫–æ–º-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–º?`;
                    break;
            }

            document.getElementById('userRole').textContent = roleText;
            document.getElementById('welcomeTitle').textContent = `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${user.fullName}!`;
            document.getElementById('welcomeMessage').textContent = welcomeMessage;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
        function loadRoleSpecificData(role) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –ø–∞–Ω–µ–ª–∏
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('parentPanel').classList.add('hidden');
            document.getElementById('childPanel').classList.add('hidden');

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–µ –ø–∞–Ω–µ–ª–∏
            switch(role) {
                case 'admin':
                    document.getElementById('adminPanel').classList.remove('hidden');
                    break;
                case 'parent':
                    document.getElementById('parentPanel').classList.remove('hidden');
                    break;
                case 'child':
                    document.getElementById('childPanel').classList.remove('hidden');
                    break;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–∑—ã–≤–∞ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—è
        function initParentReview() {
            const stars = document.querySelectorAll('#parentRatingStars .star');
            let selectedRating = 0;

            stars.forEach(star => {
                star.addEventListener('mouseover', function() {
                    const value = parseInt(this.getAttribute('data-value'));
                    highlightStars('parent', value);
                });

                star.addEventListener('mouseout', function() {
                    highlightStars('parent', selectedRating);
                });

                star.addEventListener('click', function() {
                    selectedRating = parseInt(this.getAttribute('data-value'));
                    highlightStars('parent', selectedRating);
                });
            });

            function highlightStars(type, rating) {
                const stars = document.querySelectorAll(`#${type}RatingStars .star`);
                stars.forEach(star => {
                    const value = parseInt(star.getAttribute('data-value'));
                    star.classList.toggle('active', value <= rating);
                });
            }

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–∑—ã–≤–∞
            document.getElementById('submitParentReviewBtn').addEventListener('click', function() {
                const reviewText = document.getElementById('parentReviewText').value.trim();
                const currentUser = getCurrentUser();

                if (selectedRating === 0) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –æ—Ü–µ–Ω–∫—É!');
                    return;
                }

                if (reviewText.length < 10) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –æ—Ç–∑—ã–≤ (–º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤)');
                    return;
                }

                const review = {
                    author: currentUser.fullName,
                    authorId: currentUser.id,
                    role: currentUser.role,
                    rating: selectedRating,
                    text: reviewText
                };

                const savedReview = saveReview(review);

                alert('–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –æ—Ç–∑—ã–≤! –û–Ω –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é –∏ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.');

                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('parentReviewText').value = '';
                selectedRating = 0;
                highlightStars('parent', 0);

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –æ—Ç–∑—ã–≤—ã
                loadSiteStats();
                loadAllReviews();
                if (currentUser.role === 'admin') {
                    loadLatestReviews();
                }
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–∑—ã–≤–∞ –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞
        function initChildReview() {
            const stars = document.querySelectorAll('#childRatingStars .star');
            let selectedRating = 0;

            stars.forEach(star => {
                star.addEventListener('mouseover', function() {
                    const value = parseInt(this.getAttribute('data-value'));
                    highlightStars('child', value);
                });

                star.addEventListener('mouseout', function() {
                    highlightStars('child', selectedRating);
                });

                star.addEventListener('click', function() {
                    selectedRating = parseInt(this.getAttribute('data-value'));
                    highlightStars('child', selectedRating);
                });
            });

            function highlightStars(type, rating) {
                const stars = document.querySelectorAll(`#${type}RatingStars .star`);
                stars.forEach(star => {
                    const value = parseInt(star.getAttribute('data-value'));
                    star.classList.toggle('active', value <= rating);
                });
            }

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–∑—ã–≤–∞
            document.getElementById('submitChildReviewBtn').addEventListener('click', function() {
                const reviewText = document.getElementById('childReviewText').value.trim();
                const currentUser = getCurrentUser();

                if (selectedRating === 0) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ—Å—Ç–∞–≤—å –æ—Ü–µ–Ω–∫—É!');
                    return;
                }

                if (reviewText.length < 10) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏ –æ—Ç–∑—ã–≤ (–º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤)');
                    return;
                }

                const review = {
                    author: currentUser.fullName,
                    authorId: currentUser.id,
                    role: currentUser.role,
                    rating: selectedRating,
                    text: reviewText
                };

                const savedReview = saveReview(review);

                alert('–°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–≤–æ–π –æ—Ç–∑—ã–≤! –û–Ω –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∏ —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ.');

                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('childReviewText').value = '';
                selectedRating = 0;
                highlightStars('child', 0);

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –æ—Ç–∑—ã–≤—ã
                loadSiteStats();
                loadAllReviews();
                if (currentUser.role === 'admin') {
                    loadLatestReviews();
                }
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–∞–π—Ç–∞
        function loadSiteStats() {
            const stats = getSiteStats();

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            document.getElementById('totalUsers').textContent = stats.totalUsers;
            document.getElementById('totalReviews').textContent = stats.totalReviews;
            document.getElementById('avgRating').textContent = stats.avgRating;
            document.getElementById('newToday').textContent = stats.newToday;

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–π—Ç–∏–Ω–≥ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—è
            document.getElementById('averageRating').textContent = stats.avgRating;

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞
            const ratingDesc = document.getElementById('ratingDescription');
            const avgRating = parseFloat(stats.avgRating);

            if (avgRating >= 4.5) {
                ratingDesc.textContent = '–û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥! –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ.';
            } else if (avgRating >= 3.5) {
                ratingDesc.textContent = '–•–æ—Ä–æ—à–∏–π —Ä–µ–π—Ç–∏–Ω–≥. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –¥–æ–≤–æ–ª—å–Ω—ã.';
            } else if (avgRating >= 2.5) {
                ratingDesc.textContent = '–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥. –ï—Å—Ç—å –Ω–∞–¥ —á–µ–º –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å.';
            } else {
                ratingDesc.textContent = '–ù–∏–∑–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥. –ù—É–∂–Ω—ã —É–ª—É—á—à–µ–Ω–∏—è.';
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
            const distributionContainer = document.querySelector('.rating-distribution');
            if (distributionContainer) {
                distributionContainer.innerHTML = '';

                for (let i = 5; i >= 1; i--) {
                    const count = stats.ratingDistribution[i];
                    const percent = stats.totalReviews > 0 ? Math.round((count / stats.totalReviews) * 100) : 0;

                    const item = document.createElement('div');
                    item.className = 'distribution-item';
                    item.innerHTML = `
                        <div class="distribution-star">${'‚òÖ'.repeat(i)}${'‚òÜ'.repeat(5-i)}</div>
                        <div class="distribution-bar">
                            <div class="distribution-fill" style="width: ${percent}%"></div>
                        </div>
                        <div class="distribution-percent">${percent}%</div>
                    `;
                    distributionContainer.appendChild(item);
                }
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –æ—Ç–∑—ã–≤–æ–≤ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        function loadLatestReviews() {
            const reviews = getReviews();
            const reviewsList = document.getElementById('adminReviewsList');
            reviewsList.innerHTML = '';

            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –æ—Ç–∑—ã–≤—ã –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–µ)
            const sortedReviews = [...reviews].sort((a, b) => new Date(b.date) - new Date(a.date));

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –æ—Ç–∑—ã–≤–æ–≤
            const latestReviews = sortedReviews.slice(0, 5);

            if (latestReviews.length === 0) {
                reviewsList.innerHTML = '<p style="color: #757575; text-align: center;">–û—Ç–∑—ã–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
                return;
            }

            latestReviews.forEach(review => {
                const reviewItem = document.createElement('div');
                reviewItem.className = 'review-item';

                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∫–æ–Ω–∫—É –¥–ª—è —Ä–æ–ª–∏
                let roleIcon = 'üë§';
                if (review.role === 'admin') roleIcon = 'üëë';
                if (review.role === 'parent') roleIcon = 'üë®‚Äçüë©‚Äçüëß';
                if (review.role === 'child') roleIcon = 'üë¶';

                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                let statusBadge = '';
                if (review.status === 'pending') statusBadge = '<span style="background: #FF9800; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</span>';
                if (review.status === 'approved') statusBadge = '<span style="background: #4CAF50; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">–û–¥–æ–±—Ä–µ–Ω</span>';
                if (review.status === 'rejected') statusBadge = '<span style="background: #f44336; color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem;">–û—Ç–∫–ª–æ–Ω—ë–Ω</span>';

                reviewItem.innerHTML = `
                    <div class="review-header">
                        <div class="review-author">${roleIcon} ${review.author}</div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            ${statusBadge}
                            <div class="review-date">${review.date}</div>
                        </div>
                    </div>
                    <div class="review-rating">${'‚òÖ'.repeat(review.rating)}${'‚òÜ'.repeat(5-review.rating)}</div>
                    <div class="review-text">${review.text}</div>
                    ${review.adminComments && review.adminComments.length > 0 ? `
                        <div class="comment-section">
                            <div style="font-weight: bold; color: #4a148c; margin-bottom: 5px;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</div>
                            ${review.adminComments.map(comment => `
                                <div class="comment-item">
                                    <div class="comment-header">
                                        <span class="comment-author">üëë ${comment.author}</span>
                                        <span class="comment-date">${comment.date}</span>
                                    </div>
                                    <div>${comment.text}</div>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                `;
                reviewsList.appendChild(reviewItem);
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –æ—Ç–∑—ã–≤–æ–≤
        function loadAllReviews() {
            const reviews = getReviews();
            const reviewsList = document.getElementById('allReviewsList');
            const currentUser = getCurrentUser();

            if (!reviewsList) return;

            reviewsList.innerHTML = '';

            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –æ—Ç–∑—ã–≤—ã –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–µ), –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–µ
            const sortedReviews = [...reviews]
                .filter(review => review.status === 'approved')
                .sort((a, b) => new Date(b.date) - new Date(a.date));

            if (sortedReviews.length === 0) {
                reviewsList.innerHTML = '<p style="color: #757575; text-align: center;">–û—Ç–∑—ã–≤–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
                return;
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–∞–∫—Å–∏–º—É–º 10 –æ—Ç–∑—ã–≤–æ–≤
            const displayReviews = sortedReviews.slice(0, 10);

            displayReviews.forEach(review => {
                const reviewItem = document.createElement('div');
                reviewItem.className = 'review-item';

                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–∫–æ–Ω–∫—É –¥–ª—è —Ä–æ–ª–∏
                let roleIcon = 'üë§';
                if (review.role === 'admin') roleIcon = 'üëë';
                if (review.role === 'parent') roleIcon = 'üë®‚Äçüë©‚Äçüëß';
                if (review.role === 'child') roleIcon = 'üë¶';

                reviewItem.innerHTML = `
                    <div class="review-header">
                        <div class="review-author">${roleIcon} ${review.author}</div>
                        <div class="review-date">${review.date}</div>
                    </div>
                    <div class="review-rating">${'‚òÖ'.repeat(review.rating)}${'‚òÜ'.repeat(5-review.rating)}</div>
                    <div class="review-text">${review.text}</div>
                    ${review.adminComments && review.adminComments.length > 0 ? `
                        <div class="comment-section">
                            <div style="font-weight: bold; color: #2575fc; margin-bottom: 5px; font-size: 0.9rem;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</div>
                            ${review.adminComments.map(comment => `
                                <div class="comment-item">
                                    <div class="comment-header">
                                        <span class="comment-author">üëë ${comment.author}</span>
                                        <span class="comment-date">${comment.date}</span>
                                    </div>
                                    <div>${comment.text}</div>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                    ${currentUser && currentUser.role === 'admin' ? `
                        <div class="comment-form" style="margin-top: 10px;">
                            <input type="text" class="comment-input" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." data-review-id="${review.id}">
                            <button class="comment-btn" onclick="addAdminComment('${review.id}', this)">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        </div>
                    ` : ''}
                `;
                reviewsList.appendChild(reviewItem);
            });
        }

        // –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        function addAdminComment(reviewId, button) {
            const input = button.previousElementSibling;
            const commentText = input.value.trim();
            const currentUser = getCurrentUser();

            if (!commentText) {
                alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è');
                return;
            }

            if (currentUser.role !== 'admin') {
                alert('–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏');
                return;
            }

            const reviews = getReviews();
            const reviewIndex = reviews.findIndex(r => r.id === reviewId);

            if (reviewIndex === -1) {
                alert('–û—Ç–∑—ã–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }

            if (!reviews[reviewIndex].adminComments) {
                reviews[reviewIndex].adminComments = [];
            }

            // –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
            reviews[reviewIndex].adminComments.push({
                id: Date.now().toString(),
                author: currentUser.fullName,
                text: commentText,
                date: new Date().toLocaleDateString('ru-RU') + ' ' +
                      new Date().toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'})
            });

            localStorage.setItem(REVIEWS_KEY, JSON.stringify(reviews));

            // –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ –≤–≤–æ–¥–∞
            input.value = '';

            // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            loadAllReviews();
            if (currentUser.role === 'admin') {
                loadLatestReviews();
            }

            alert('–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–±–∞–≤–ª–µ–Ω');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–µ—Ç–µ–π –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—è
        function loadChildren(parentId) {
            const children = getChildren(parentId);
            const container = document.getElementById('childrenList');

            if (children.length === 0) {
                container.innerHTML = '<p style="color: #666; text-align: center;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –¥–µ—Ç–µ–π</p>';
                return;
            }

            let html = '';
            children.forEach((child, index) => {
                // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ–±–µ–Ω–∫–∞
                const progress = getUserProgress(child.id);
                const completedThemes = Object.values(progress).filter(v => v === true).length;
                const totalThemes = 7;
                const progressPercent = Math.round((completedThemes / totalThemes) * 100);

                html += `
                    <div class="child-item">
                        <div>
                            <div class="child-name">${child.name}</div>
                            <div class="child-age">${child.age} –ª–µ—Ç</div>
                        </div>
                        <div class="child-progress">${progressPercent}%</div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞
        function loadChildProgress(childId) {
            const progress = getUserProgress(childId);
            const completedThemes = Object.values(progress).filter(v => v === true).length;
            const totalThemes = 7;
            const progressPercent = Math.round((completedThemes / totalThemes) * 100);

            document.getElementById('childProgressPercent').textContent = `${progressPercent}%`;
            document.getElementById('childProgressText').textContent = `${completedThemes} –∏–∑ ${totalThemes} —Ç–µ–º –∏–∑—É—á–µ–Ω–æ`;
            document.getElementById('childProgressBar').style.width = `${progressPercent}%`;
        }

        // –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–±–µ–Ω–∫–∞
        function openAddChildModal() {
            document.getElementById('addChildModal').style.display = 'flex';
        }

        // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–±–µ–Ω–∫–∞
        function closeAddChildModal() {
            document.getElementById('addChildModal').style.display = 'none';
            document.getElementById('addChildForm').reset();
        }

        // –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–±–µ–Ω–∫–∞
        function addChild(event) {
            event.preventDefault();

            const currentUser = getCurrentUser();
            if (currentUser.role !== 'parent') {
                alert('–¢–æ–ª—å–∫–æ —Ä–æ–¥–∏—Ç–µ–ª–∏ –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –¥–µ—Ç–µ–π');
                return;
            }

            const childName = document.getElementById('childName').value.trim();
            const childAge = parseInt(document.getElementById('childAge').value);

            if (!childName || childAge < 3 || childAge > 7) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
                return;
            }

            const children = getChildren(currentUser.id);

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —Ä–µ–±–µ–Ω–∫–∞ —Å —Ç–∞–∫–∏–º –∂–µ –∏–º–µ–Ω–µ–º
            if (children.some(child => child.name.toLowerCase() === childName.toLowerCase())) {
                alert('–†–µ–±–µ–Ω–æ–∫ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω');
                return;
            }

            // –°–æ–∑–¥–∞–µ–º ID –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞
            const childId = `child_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;

            children.push({
                id: childId,
                name: childName,
                age: childAge,
                parentId: currentUser.id,
                createdAt: new Date().toISOString()
            });

            saveChildren(currentUser.id, children);
            closeAddChildModal();
            loadChildren(currentUser.id);
            updateUserInfo(currentUser);

            alert(`–†–µ–±–µ–Ω–æ–∫ ${childName} —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!`);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function updateProgress(user) {
            const progress = getUserProgress(user.id);
            const completed = Object.values(progress).filter(v => v === true).length;
            const percent = Math.round((completed / 7) * 100);

            document.getElementById('themesCompleted').textContent = `${completed} –∏–∑ 7`;
            document.getElementById('progressBar').style.width = `${percent}%`;

            // –î–ª—è —Ä–µ–±–µ–Ω–∫–∞ —Ç–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –ø–∞–Ω–µ–ª—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            if (user.role === 'child') {
                document.getElementById('childProgressPercent').textContent = `${percent}%`;
                document.getElementById('childProgressText').textContent = `${completed} –∏–∑ 7 —Ç–µ–º –∏–∑—É—á–µ–Ω–æ`;
                document.getElementById('childProgressBar').style.width = `${percent}%`;
            }
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', initPage);

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
        document.querySelectorAll('.modal-overlay').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
[file content end]
